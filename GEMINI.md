# 今後対応すべきこと

## Puppeteer のスケーリング戦略

現状はリクエストごとにブラウザを起動する「フェーズ1（リソース強化）」で運用していますが、負荷増大やパフォーマンス改善のために以下のステップへの移行を検討してください。

### フェーズ2：ブラウザのプール（中規模運用）
- `puppeteer-cluster` 等を導入し、ブラウザを常時起動させて「新しいタブ」で処理する。
- 起動時間がほぼゼロになり、レスポンスが高速化。
- 定期的な再起動ロジックによるメモリリーク対策が必要。

### フェーズ3：外部PDF生成サービスの利用（ベストプラクティス）
- **Browserless.io (SaaS)**: 接続先を外部URLに変えるだけでブラウザ管理を完全に自動化。
- **Gotenberg (自前コンテナ)**: PDF生成専用コンテナを別のCloud Runとして動かし、役割を分離。
- アプリケーションサーバーの軽量化とスケーリング効率の最大化。

## Puppeteer のスケーリング戦略

現状はリクエストごとにブラウザを起動する「フェーズ1（リソース強化）」で運用していますが、負荷増大やパフォーマンス改善のために以下のステップへの移行を検討してください。

### フェーズ2：ブラウザのプール（中規模運用）
- `puppeteer-cluster` 等を導入し、ブラウザを常時起動させて「新しいタブ」で処理する。
- 起動時間がほぼゼロになり、レスポンスが高速化。
- 定期的な再起動ロジックによるメモリリーク対策が必要。

### フェーズ3：外部PDF生成サービスの利用（ベストプラクティス）
- **Browserless.io (SaaS)**: 接続先を外部URLに変えるだけでブラウザ管理を完全に自動化。
- **Gotenberg (自前コンテナ)**: PDF生成専用コンテナを別のCloud Runとして動かし、役割を分離。
- アプリケーションサーバーの軽量化とスケーリング効率の最大化。
